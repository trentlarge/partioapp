<template name="adminSearchDetails">
    {{#contentFor "headerButtonLeft"}}
        {{>ionNavBackButton}}
    {{/contentFor}}

    {{#contentFor "headerTitle"}}
        <h1 class="title" style="text-align:center;">Search</h1>
    {{/contentFor}}

    {{#contentFor "headerButtonRight"}}
        <a href="/" class="button button-clear">
            <img id="spinner-logo-simple" src="{{ getImage 'spinner-logo' }}" />
        </a>
    {{/contentFor}}
    
    {{#ionView}}
        {{#ionContent class="admin-search-details"}}    

        {{#if isUserPermited}}
    
            <div class="list">
                
                {{#if isUserDetails}}

                    {{#with user}}

                        <div class="card list">
                            <div class="profilehead item" >
                                <div class="profile-image-container">
                                    <div class="profile-avatar" style="background: url('{{profile.avatar}}') no-repeat; background-size:cover; background-position: 50% 50%;"></div>
                                </div>
                                <div class="center">
                                    <span class="profile-name">{{profile.name}}</span>
                                    <span  class="rating-box">{{ > rating}}</span>
                                </div>
                            </div>

                            <div class="item item-input">
                                <i class="icon ion-ios-email"></i>
                                <input id="email" type="text" value="{{ emails.[0].address }}" disabled>
                            </div>
                            <div class="item item-input">
                                <i class="icon ion-ios-telephone"></i>
                                <input id="mobile" type="text" value="{{ private.mobile }}" disabled>
                            </div>
                            <div class="item item-input">
                                <i class="icon ion-ios-calendar"></i>
                                <input id="birthDate" data-date-format="mm/dd/yyyy" type="text" value="{{ profile.birthDate }}" disabled>
                            </div>
                            <div class="item item-input item-select">
                                <i class="icon ion-android-locate"></i>
                                <div class="input-label border-radius-20"><p>Location</p></div>
                                {{#if ../userCanUpdate}} 
                                     <select id="college" class="border-radius-20">
                                        <option value="1" {{isLocationSelected 1}}>Duke University</option>
                                        <option value="2" {{isLocationSelected 2}}>Yale University</option>
                                        <option value="0" {{isLocationSelected 0}}>Other</option>
                                    </select>
                                {{else}}
                                    <select id="college" class="border-radius-20" disabled>
                                        <option value="1" {{isLocationSelected 1}}>Duke University</option>
                                        <option value="2" {{isLocationSelected 2}}>Yale University</option>
                                        <option value="0" {{isLocationSelected 0}}>Other</option>
                                    </select>
                                {{/if}}
                            </div>
                                
                            <div class="item no-padding-vertical">
                                {{#if ../userCanUpdate}}
                                    <button class="button button-block button-energized update-user" {{updateMode}}>UPDATE</button>
                                {{/if}}
                                {{#if ../userCanDelete}}
                                    <button class="button button-block button-assertive delete-user">DELETE</button>
                                {{/if}}
                            </div>
                        </div>
                
                        <div class="card list">
                            <a class="item item-icon-right" href="/admin/promotions/details/{{_id}}">
                                <p>Promotions</p>
                                {{> ionIcon icon="ios-arrow-right" class="energized right-arrow"}}
                            </a>    
                        </div>

                        <div class="card list">
                            <div class="item item-divider">
                                <h2>Products</h2>
                            </div>
                            <div class="item">
                                <span>Total: {{../getUserProductsLength}}</span>
                            </div>    
                        </div>

                        <div class="card list">
                            <div class="item item-divider">
                                <h2>Connections</h2>
                            </div>
                            <div class="item">
                                <span>Total (Owner): {{../getUserConnectionsOwnerLength}}</span>
                            </div>
                            <div class="item">
                                <span>Total (Requestor): {{../getUserConnectionsRequestorLength}}</span>
                            </div>
                        </div>

                        <div class="card list">
                            <div class="item item-divider">
                                <h2>Transactions</h2>
                            </div>
                            <div class="item">
                                <span>Total (Spending): {{../getUserTransactionsSpendingLength}}</span>
                            </div>
                            <div class="item">
                                <span>Total (Earning): {{../getUserTransactionsEarningLength}}</span>
                            </div>
                        </div>

                    {{/with}}

                {{/if}}
                
                {{#if isProductDetails}}
                
                    {{#with product}}
                
                        <div class="card">
                            <div class="item">
                                <span class="product-title">{{title}}</span>
                                <div class="image-container">
                                    <img src="{{image}}">
                                </div>
                            </div>
                            
                            <div class="item item-input item-select">
                                <div class="input-label">
                                  <p>Condition:</p>
                                </div>
                                <select class="condition" disabled>
                                  {{#each ../getConditions}}
                                    <option value="{{index}}" {{selectedCondition index}}>{{value}}</option>
                                  {{/each}}
                                </select>
                            </div>

                            <div class="item item-input item-select no-border">
                                <div class="input-label">
                                  <p style="height:16px;">Category:</p>
                                </div>
                                <select class="category" disabled>
                                    {{#each ../getCategories}}
                                        <option {{selectedCategory text}}>{{text}}</option>
                                    {{/each}}
                                </select>
                            </div>
                            
                            <div class="item item-divider">
                                <h2>Rent Price</h2>
                            </div>

                            <div class="item row">
                                <div class="col col-50">
                                    <div class="priceLabel">DAY</div>
                                    <input type="number" class="price dayPrice" value="{{rentPrice.day}}" placeholder="0.00" disabled>
                                </div>
                                <div class="col col-50">
                                    <div class="priceLabel">WEEK</div>
                                    <input type="number" class="price weekPrice" value="{{rentPrice.week}}" placeholder="0.00" disabled>
                                </div>
                                </div>
                                <div class="item row no-border">
                                <div class="col col-50">
                                    <div class="priceLabel">MONTH</div>
                                    <input type="number" class="price monthPrice" value="{{rentPrice.month}}" placeholder="0.00" disabled>
                                </div>
                                <div class="col col-50">
                                    <div class="priceLabel">SEMESTER</div>
                                    <input type="number" class="price semesterPrice" value="{{rentPrice.semester}}" placeholder="0.00" disabled>
                                </div>
                            </div>
                            
                            <div class="item item-divider">
                                Purchasing
                            </div>

                            <div class="item row">
                                <div class="col col-50">
                                    <div class="priceLabel">PRICE</div>
                                    <input type="number" class="price sellingPrice" value="{{selling.price}}" placeholder="0.00" disabled>
                                </div>
                                <div class="col col-50">
                                     <label class="toggle toggle-assertive">
                                       <input type="checkbox" {{../sellingStatusChecked}} disabled>
                                       <div class="track">
                                         <div class="handle"></div>
                                       </div>
                                     </label>
                                     {{#if ../isSellingStatusOn}}
                                        <span class="enablePurchasing">ON</span>
                                     {{else}}
                                        <span class="enablePurchasing">OFF</span>
                                     {{/if}}
                                </div>
                           </div>
                            
                        </div>
                
                        {{#with ../getUser ownerId}}
                            <div class="card">
                                <a class="item item-avatar" href="/admin/search/users/{{_id}}">
                                  <img src="{{profile.avatar}}">
                                  <span class="user-name">{{profile.name}}</span> 
                                  <div class="item-icon-right">
                                    {{> ionIcon icon="ios-arrow-right" class="energized right-arrow"}}
                                  </div>    
                                </a>
                            </div>
                        {{/with}}
                
                    {{/with}}
                
                {{/if}}

                {{#if isConnectionDetails}}
                
                    {{#with connection}}
                
                        <div class="list card">
                            <div class="item">
                                <span class="product-title">{{productData.title}}</span>
                                <div class="image-container">
                                    <img src="{{productData.image}}">
                                </div>
                            </div>
                        </div>
                
                        <div class="list card">
                            <div class="item item-divider">Owner</div>
                            <div class="item item-avatar">
                              <img src="{{productData.ownerData.profile.avatar}}">
                              <span class="user-name">{{productData.ownerData.profile.name}}</span>
                            </div>
                        </div>
                
                        <div class="list card">
                            <div class="item item-divider">Requestor</div>
                            <div class="item item-avatar">
                              <img src="{{requestorData.profile.avatar}}">
                              <span class="user-name">{{requestorData.profile.name}}</span>
                            </div>
                        </div>
                
                        <div class="list card">
                            <table class="connection-details-table">
                                <tr>
                                    <td> Request </td>
                                    <td> {{../formatDate requestDate}} </td>
                                </tr>
                                <tr>
                                    <td> Total </td>
                                    <td> ${{borrowDetails.price.total}} </td>
                                </tr>
                                {{#if borrowDetails.date}}
                                    <tr>
                                        <td> Total Days </td>
                                        <td> {{borrowDetails.date.totalDays}} </td>
                                    </tr>
                                    <tr>
                                        <td> Start Date </td>
                                        <td> {{../formatDate borrowDetails.date.start}} </td>
                                    </tr>
                                    <tr>
                                        <td> End Date</td>
                                        <td> {{../formatDate borrowDetails.date.end}} </td>
                                    </tr>
                                {{/if}}
                            </table>
                
                        </div>
                
                        <div class="list card">
                            <table class="connection-details-table">
                                <tr>
                                    <td> State </td>
                                    <td> {{state}} </td>
                                </tr>
                                
                                <tr>
                                    <td> Finished </td>
                                    {{#if finished}}
                                        <td> YES </td>
                                    {{else}}
                                        <td> NO </td>
                                    {{/if}}
                                </tr>
                                
                                {{#if promotion}}
                                    <tr>
                                        <td> Promotion </td>
                                        {{#if promotion.status}}
                                            <td> YES - ${{promotion.value}}</td>
                                        {{else}}
                                            <td> NO </td>
                                        {{/if}}
                                    </tr>
                                {{/if}}
                                
                                {{#if report.confirmed}}
                                    <tr>
                                        <td> Refund </td>
                                        <td> YES </td>
                                    </tr>
                                {{/if}}
                            </table>
                        </div>
                
                        {{#if report.problems}}
                            <div class="list card">
                                <table class="connection-details-table">

                                    <tr>
                                        <td> Reported </td>
                                        <td> YES </td>
                                    </tr>
                                    <tr>
                                        <td>Date</td>
                                        <td>{{../formatDate report.timestamp}} {{../getTime report.timestamp}}</td>
                                    </tr>
                                    
                                    {{#if report.ignored}}
                                        <tr>
                                            <td> Ignored </td>
                                            <td> YES </td>
                                        </tr>
                                    {{/if}}

                                    {{#if report.problems}}
                                        <tr>
                                            <td> Problems </td>
                                            <td>
                                                {{#if report.problems.broken}} <p>Item broken</p> {{/if}}
                                                {{#if report.problems.working}} <p>Item not working</p> {{/if}}
                                                {{#if report.problems.condition}} <p>Condition not match</p> {{/if}}
                                            </td>
                                        </tr>
                                    {{/if}}

                                    {{#if report.returned}}
                                        <tr>
                                            <td> Returned </td>
                                            {{#if report.returned.status}}
                                                <td> YES </td>
                                            {{else}}
                                                <td> NO </td>
                                            {{/if}}
                                        </tr>
                                        <tr>
                                            <td>Returned Date</td>
                                            <td>{{../formatDate report.returned.timestamp}} {{../getTime report.returned.timestamp}}</td>
                                        </tr>
                                    {{/if}}

                                    {{#if report.confirmed}}
                                        <tr>
                                            <td> Confirmed </td>
                                            {{#if report.confirmed.status}}
                                                <td> YES </td>
                                            {{else}}
                                                <td> NO </td>
                                            {{/if}}
                                        </tr>
                                        <tr>
                                            <td>Confirmed Date</td>
                                            <td>{{../formatDate report.confirmed.timestamp}} {{../getTime report.confirmed.timestamp}}</td>
                                        </tr>
                                    {{/if}}

                                </table>

                            </div>
                        {{/if}}
                
                    {{/with}}
                            
                {{/if}}
                
            </div>
    
        {{/if}}
    
        {{/ionContent}}
    {{/ionView}}

</template>
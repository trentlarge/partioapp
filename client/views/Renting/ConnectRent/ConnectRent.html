<template name="connectRent">
  {{#contentFor "headerButtonLeft"}}
      {{>ionNavBackButton path="renting"}}
  {{/contentFor}}

  {{#contentFor "headerTitle"}}
    <h1 class="title">Rent Request</h1>
  {{/contentFor}}

  {{#ionView class="connectRent-view"}}
    {{#ionContent class="connectRent prevent-keyboardglitch"}}
      <div class="card padding-horizontal padding-vertical list">
          
        <div class="item item-divider product-details"><h2>Product Details <i class="chevron-icon icon ion-chevron-up"></i></h2></div>

        <div class="item product-details-item">
          <div class="product-image-box">
              <img class="connect-thumbnail" src="{{connectData.productData.image}}">
          </div>
          <div class="product-content">
              <p class="product-title">{{connectData.productData.title}}</p>
              <p><i class="icon {{../getCategoryIcon}}"></i> {{connectData.productData.amazonCategory}}</p>
              <p><i class="icon ion-cash"></i> {{connectData.productData.price}}</p>
              <p><i class="icon ion-clipboard"></i> {{../getCondition}}</p>
          </div>
        </div>

        <div class="item product-details-item center hidden">
          <table class="rent-table">
            <tbody class="prices">
            <tr>
              <th><i>D</i></th>
              <th><i>W</i></th>
              <th><i>M</i></th>
              <th><i>S</i></th>
            </tr>
            <tr>
              <td>${{connectData.productData.rentPrice.day}}</td>
              <td>${{connectData.productData.rentPrice.week}}</td>
              <td>${{connectData.productData.rentPrice.month}}</td>
              <td>${{connectData.productData.rentPrice.semester}}</td>
            </tr>
            </tbody>
          </table>
        </div>

        <div class="item item-divider profile-details"><h2>Lending Details</h2></div>

        <div class="item request-date">
            <span>{{../getRequestDate}}</span>
        </div>  
          
        <div class="item">
          <div class="profile-image-box">
            <a href="/profile/items/{{ connectData.owner }}"> 
                <div style="background: url('{{connectData.productData.ownerData.profile.avatar}}') no-repeat; background-size:cover; background-position: 50% 50%;" class="profile-avatar"></div>
            </a>
            <p class="main-title-text">{{connectData.productData.ownerData.profile.name}} </p>
<!--            <p class="college">{{connectData.productData.ownerData.profile.college}}</p>-->
          </div>
            <div class="profile-content">
                <a class="item" href="{{pathFor 'talk' _id=connectData._id}}">
                    <i class="icon ion-chatbubbles assertive"></i>
                    CHAT
                </a>
                <a class="item" id="btnCallUser">
                    <i class="icon ion-ios-telephone assertive"></i>
                    CALL
                </a>

                {{#if ../paymentPending}}
                    <a class="item" id="cancelRequest">
                        <i class="icon ion-ios-close royal"></i>
                        CANCEL
                    </a>
                {{/if}}
            </div>
          </div>
          <div class="item details">
                <i class="icon ion-ios-calendar-outline"></i> 
                {{../getTotalDays}} ({{../getStartDate}} to {{../getEndDate}})
          </div>
          <div class="item details">
                <i class="icon ion-ios-clock-outline"></i> 
                {{../getDaysLeft}}
                <input type="range" id="myRange" min="0" max="{{connectData.borrowDetails.date.totalDays}}" value="{{../getDaysLeftValue}}" class="range range-assertive" disabled>
          </div>
          <div class="item details">
                <i class="icon ion-cash"></i>
                <span class="price">${{connectData.borrowDetails.price.total}}</span>
          </div>
          {{#if ../isReturned}}
          {{else}}
              <div class="item details">
                  <i class="icon ion-location"></i>
                  <a id="showMap" href="#">
                    <p>{{preferredLocation}}</p>
                  </a>
              </div>
          {{/if}}
          
          <div style="padding-bottom:16px;"></div>
<!--
          <div class="profile-content">
            <table class="borrow-details">
              <tbody>
                <tr>
                  <td> {{../getRequestDate}} </td>
                </tr>
                <tr>
                  <td class="divider"> <i class="icon ion-ios-calendar-outline"></i> 
                      <b>Period:</b> {{../getTotalDays}} 
                  </td>
                </tr>
                <tr>
                  <td>
                    {{#if ../isTimeOver}}
                        <span style="color:red">
                            <i class="icon ion-ios-clock-outline"></i> {{../getDaysLeft}}
                        </span>
                    {{else}}
                        <i class="icon ion-ios-clock-outline"></i> {{../getDaysLeft}}
                    {{/if}}
                  </td>
                </tr>
                <tr>
                  <td class="date-range"> {{../getStartDate}} to {{../getEndDate}} </td>
                </tr>
                <tr>
                  <td class="divider"> <i class="icon ion-cash"></i> <b>Price:</b> </td>
                </tr>
                <tr>
                  <td> Total: <span class="price">${{connectData.borrowDetails.price.total}}</span> </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="item tabs tabs-icon-left">
          <a class="tab-item" href="{{pathFor 'talk' _id=connectData._id}}">
            <i class="icon ion-chatbubbles assertive"></i>
            CHAT
          </a>
          <a class="tab-item" id="btnCallUser">
            <i class="icon ion-ios-telephone assertive"></i>
            CALL
          </a>

          {{#if ../paymentPending}}
            <a class="tab-item" id="cancelRequest">
              <i class="icon ion-ios-close royal"></i>
              CANCEL
            </a>
          {{/if}}
        </div>
-->

<!--
        {{#if ../isReturned}}
        {{else}}
          <div class="item item-divider meetup">
            <h2>Meetup Location</h2>
          </div>
          <a class="item item-button-right" id="showMap" href="#">
            <p>{{preferredLocation}}</p>
          </a>
        {{/if}}
-->

        {{#if ../paymentDone}}
          {{#unless ../itemReturnDone}}
            <div class="item">
                <button id="returnItem" class="button button-block">RETURN ITEM</button>
            </div>
          {{/unless}}
        {{else}}
          <div class="item">
              {{#if ../approvedStatus}}
                <button id="payAndRent" class="button button-block button-energized">PAY TOTAL &nbsp; ${{connectData.borrowDetails.price.total}}</button>
              {{else}}
                {{#if ../isTimeOver}}
                    <button class="button button-block" disabled>TIME IS OVER</button>
                {{else}}
                    <button id="payAndRent" class="button button-block button-energized disabled">AWAITING APPROVAL</button>
                {{/if}}
              {{/if}}
          </div>
        {{/if}}
      </div>
        
      <div class="center">
        <a class="email-support" href="mailto:support@partioapp.com" data-rel='external'>CONTACT US</a>
      </div>
    
    {{/ionContent}}
  {{/ionView}}
</template>

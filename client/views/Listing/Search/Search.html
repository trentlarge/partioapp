<template name="search">
  {{#contentFor "headerButtonLeft"}}
      {{>ionNavBackButton   }}
  {{/contentFor}}

  {{#contentFor "headerTitle"}}
    <h1 class="title" style="text-align:center;">Select from Owner</h1>
  {{/contentFor}}

  {{#ionView}}
    {{#ionContent class="listing-search overflow-scroll"}}

<!--    <div class="item item-divider product-header-title"><h2>{{ product.title }}</h2></div>-->

    {{#if Template.subscriptionsReady}}
        <script>
            Meteor.setTimeout(function(){
                $('.loadbox').fadeOut('medium',function(){
                    $('.loading-wrapper').fadeIn('medium');
                });
            }, 1000);
        </script>
    {{/if}}

    {{>loader}}

    <div class="loading-wrapper">
        <div class="card card-limited list">
<!--            <div class="item item-divider">Product Details</div>-->

            <div class="item">
                <span class="product-title">{{product.title}}</span>
                <div class="image-container">
                    <a data-ion-modal="slideImages">
                        <img src="{{product.image}}">
                    </a>
                </div>
            </div>


<!--
            <div class="item product">
                <div class="product-avatar">
                    <a data-ion-modal="slideImages">
                        <img class="product-avatar-inner" src="{{product.image}}">
                    </a>
                </div>
            </div>

            <div class="item title">
                <div class="card">
                    <p class="product-title-text">{{product.title}}</p>
                </div>
            </div>
-->

<!--            <div class="item item-divider">Rent Details</div>-->

            <div class="item">

                <div class="profile-image-box">
                    <a href="/profile/items/{{ product.ownerData._id }}" class="profile-avatar-box">
                        <div style="background: url({{ product.ownerData.profile.avatar }}) no-repeat; background-size:cover; background-position: 50% 50%;" class="profile-avatar"></div>
                    </a>
                    <p class="main-title-text"> {{ product.ownerData.profile.name }} </p>
                    <span class="rating-box">{{ > rating}}</span>
                </div>
                <div class="rent-details-box">

                    {{#if listingProduct}}
                        {{#if tabBuy}}
                            <p class="price"> <i class="icon ion-cash"></i> Buy Price: </p>
                            <p class="buy-price">${{product.selling.price}}</p>
                        {{else}}
                            <p class="price"> <i class="icon ion-cash"></i> Rent Price: </p>
                            <table class="rent-table">
                                <tbody>
                                    <tr>
                                        <th class="one"><i class="icon">DAY</i></th>
                                        <th class="two"><i class="icon">WEEK</i></th>
                                        <th class="three"><i class="icon">MONTH</i></th>
                                        <th class="four"><i class="icon">SEMESTER</i></th>
                                    </tr>
                                    <tr>
                                        <td>{{product.rentPrice.day}}</td>
                                        <td>{{product.rentPrice.week}}</td>
                                        <td>{{product.rentPrice.month}}</td>
                                        <td>{{product.rentPrice.semester}}</td>
                                    </tr>
                                </tbody>
                            </table>
                        {{/if}}
                    {{else}}
                        <p class="price"> <i class="icon ion-cash"></i> Rent Price: </p>
                        <table class="rent-table">
                            <tbody>
                                <tr>
                                    <th class="one"><i class="icon">DAY</i></th>
                                    <th class="two"><i class="icon">WEEK</i></th>
                                    <th class="three"><i class="icon">MONTH</i></th>
                                    <th class="four"><i class="icon">SEMESTER</i></th>
                                </tr>
                                <tr>
                                    <td>{{product.rentPrice.day}}</td>
                                    <td>{{product.rentPrice.week}}</td>
                                    <td>{{product.rentPrice.month}}</td>
                                    <td>{{product.rentPrice.semester}}</td>
                                </tr>
                            </tbody>
                        </table>
                    {{/if}}

                    <p class="condition">Condition: <b>{{ ../getCondition }}</b></p>

                    {{#if ../requestSent ownerId _id}}
                        {{#if ../isBorrowedByUser ownerId _id}}
                            <button class="button button-block" disabled>
                                REQUEST SENT
                            </button>
                        {{else}}
                            {{#if isPurchasingByUser}}
                                <button class="button button-block" disabled>
                                    PURCHASING
                                </button>
                            {{else}}
                                <button class="button button-block" disabled>
                                    BORROWED
                                </button>
                            {{/if}}
                        {{/if}}
                    {{else}}
                        {{#if ../isNotOwner _id}}
                            {{#if ../isUnavailable ownerId _id}}
                                <button class="button button-block" disabled>
                                    UNAVAILABLE
                                </button>
                            {{else}}
                                {{#if listingProduct}}
                                    {{#if tabBuy}}
                                        <button id="buyProduct" class="button button-block button-energized">
                                            REQUEST
                                        </button>
                                    {{else}}
                                        <button id="requestProduct" class="button button-block button-energized">
                                            REQUEST
                                        </button>
                                    {{/if}}
                                {{else}}
                                    {{#if ../isRentingStatusOn}}
                                        <button id="requestProduct" class="button button-block button-energized">
                                            REQUEST
                                        </button>
                                    {{/if}}
                                    {{#if ../isSellingStatusOn}}
                                        <a id="buyProduct" class="button-energized">
                                            BUY FOR ${{product.selling.price}}
                                        </a>
                                    {{/if}}
                                {{/if}}
                            {{/if}}
                        {{/if}}
                    {{/if}}
                </div>
            </div>
        </div>
    </div>

    {{/ionContent}}
  {{/ionView}}

</template>

<template name="slideImages">

    {{#ionModal title="Images" class="listing-search slide-images"}}

        {{#ionSlideBox}}
            {{#each slideElements}}
                {{#ionSlide}}
                <div class="product-avatar">
                    <img class="slide-image" src="{{photo}}"/>
                </div>
                {{/ionSlide}}
            {{/each}}
        {{/ionSlideBox}}

    {{/ionModal}}
</template>

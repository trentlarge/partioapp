<template name="connect">
  {{#contentFor "headerButtonLeft"}}
      {{>ionNavBackButton path="inventory"}}
  {{/contentFor}}

  {{#contentFor "headerTitle"}}
    <h1 class="title">Rent Request</h1>
  {{/contentFor}}

  {{#ionView}}
    {{#ionContent class="connect prevent-keyboardglitch"}}
    
      <div class="padding-horizontal padding-vertical list">

        {{#if isBorrowed}} 
            <div class="item center">
                <div class="center" style="width:100%">
                    {{getDaysLeft}}
                </div>
            </div>    
        {{/if}}
          
        <div class="item">
            
            {{#with userInfo}}
                <div class="profile-image-box">
                    {{#if noProfileYet}}
                    <div style="background: url('profile_image_placeholder.jpg') no-repeat; background-size:cover; background-position: 50% 50%;" class="profile-avatar"></div>
                    {{else}}
                    <div style="background: url('{{avatar}}') no-repeat; background-size:cover; background-position: 50% 50%;" class="profile-avatar"></div>
                    {{/if}}

                    <p class="main-title-text">{{name}} </p>
                    <p class="college">{{college}}</p>
                    <span class="rating-box"> {{> rating}}</span>
                </div>
            {{/with}}
            
            <div class="profile-content">
                <table class="borrow-details">
                    <tbody>
                        <tr>
                            <td> {{getRequestDate}} </td>
                        </tr>
                        <tr>
                            <td class="divider"> <i class="icon ion-ios-calendar-outline"></i> Period: </td>
                        </tr>
                        <tr>
                            <td> {{getTotalDays}} </td>
                        </tr>
                        <tr>
                            <td> {{getStartDate}} to {{getEndDate}} </td>
                        </tr>
                         <tr>
                            <td class="divider"> <i class="icon ion-cash"></i> Price: </td>
                        </tr>
                        <tr>
                            <td> Total: <span class="price">${{borrowDetails.price.total}}</span> </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="item item-divider product-details"><h2>Product Details <i class="chevron-icon icon ion-chevron-right"></i></h2></div>
          
        <div class="item product-details-item hidden">
          
            <div class="product-image-box">
                <img class="connect-thumbnail" src="{{productData.image}}">
            </div>
          
            <div class="product-content">
                <p class="product-title">{{productData.title}}</p>
                <p><i class="icon {{getCategoryIcon}}"></i> {{productData.amazonCategory}}</p>
                <p><i class="icon ion-cash"></i> {{productData.price}}</p>
                <p><i class="icon ion-clipboard"></i> {{getCondition}}</p>
            </div>

        </div>
          
        <div class="item product-details-item center hidden">
            <table class="rent-table">
                <tbody class="prices">
                <tr>
                    <th><i>D</i></th>
                    <th><i>W</i></th>
                    <th><i>M</i></th>
                    <th><i>S</i></th>
                </tr>
                <tr>
                    <td>${{productData.rentPrice.day}}</td>
                    <td>${{productData.rentPrice.week}}</td>
                    <td>${{productData.rentPrice.month}}</td>
                    <td>${{productData.rentPrice.semester}}</td>
                </tr>
                </tbody>
            </table>
        </div>
          
        <div class="item tabs tabs-icon-left">
            <a class="tab-item" href="/chat/{{this._id}}">
                <i class="icon ion-ios-chatboxes assertive"></i>
                CHAT
            </a>

            <a class="tab-item" id="btnCallUser">
                <i class="icon ion-ios-telephone assertive"></i>
                CALL
            </a>

            {{#if paymentPending}}    
            <a class="tab-item" id="cancelRequest">
                <i class="icon ion-ios-close royal"></i>
                REJECT
            </a>
            {{/if}}
        </div>
    
        {{#if alreadyApproved}}

            {{#if isReturned}}
            {{else}}
                <div class="item item-divider">
                    <h2>Set Meetup Location</h2>
                </div>
                <a class="item item-button-right" id="changeMeetupLocation" href="#">
                    <p>{{preferredLocation}}</p>
                    <button class="button button-outline button-energized"><i class="icon ion-ios-location"></i></button>
                </a>
            {{/if}}

            {{#if returnItem}}
                <button id="confirmReturn" class="button button-block">CONFIRM RETURN</button>
            {{/if}}

        {{else}}
            <button id="ownerAccept" class="button button-block button-energized">ALLOW RENTING</button>
        {{/if}}

      </div>
    {{/ionContent}}
  {{/ionView}}
</template>
